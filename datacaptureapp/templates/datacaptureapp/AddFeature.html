{% extends "datacaptureapp/base.html" %}

{% block content %}
  <BR>
    <h1 class="text-center">Add Data</h1>
	<BR>

  <form method="POST" action="{% url 'addnode' attributes.first.id %}" id="storeDataPoint">
  <div class="form-group">

      <div class="container center_div">
           <div class="form-group">
               {% csrf_token %}
               {% for attribute in attributes %}
                   <label for="{{ attribute.name }}">{{ attribute.name }}</label>
                   <input  class="form-control" id="{{ attribute.name }}" type="{{ attribute.type }}">
               {% endfor %}
                <input class="form-control" type="hidden" id="latitude">
                <input class="form-control" type="hidden" id="longitude">
      </div>

<BR>

          <button  type="submit" class="btn btn-primary">Store data point</button>

  </div>
  </div>
</form>

    <script>
         function showPosition(position) {
            document.getElementById("latitude").value = position.coords.latitude;
            document.getElementById("longitude").value = position.coords.longitude;
         }

        $('#storeDataPoint').submit(function() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition);
                return true
            } else {
                alert("Geolocation is not supported by this browser")
                return false
            }
        })
    </script>

{% endblock %}